---
# Everything
  - hosts: all
    tasks:
      - name: install common packages
        package:
          name: "{{ item.name }}"
          state: present
        with_items: "{{ common_packages }}"

# Groups
  - hosts: vm
    roles:
      - role: proxmox_vm

  - hosts: nas
    roles:
      - role: mount_disks
      - role: mrlesmithjr.zfs
        tags:
          - disks
          - zfs
      - role: sprat.ansible_role_mergerfs
        tags:
          - disks
          - mergerfs
      - role: bertvv.samba
        tags:
          - samba
      - role: weareinteractive.ufw
      - role: exterrestris.ansible_role_wsdd

# Host Specific
  - hosts: spacedock
    roles:
      - role: ironicbadger.ansible_role_proxmox_nag_removal
      - role: proxmox_host
        tags: proxmox
      - role: exterrestris.proxmox_ssl
        tags: ssl

  - hosts: memory_alpha
    roles:
      - role: exterrestris.ansible_users
        tags:
          - users

  - hosts: memory_beta
    roles:
      - role: exterrestris.ansible_users
        tags:
          - users
