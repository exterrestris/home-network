---
# Setup - Common
  - hosts: all
    tasks:
      - name: install common packages
        package:
          name: "{{ item.name }}"
          state: present
        with_items: "{{ common_packages }}"

# Setup - Host Specific
  - hosts: spacedock
    roles:

  - hosts: memory_alpha
    roles:
      - role: exterrestris.ansible_users
        tags:
          - users
      # Update kernel to HWE (5.8) to add support for Renesas USB controller
      - role: alvistack.kernel
        vars:
          kernel_release: "mainline"
        tags: kernel

  - hosts: memory_beta
    roles:
      - role: exterrestris.ansible_users
        tags:
          - users

# Setup - Groups
  - hosts: proxmox_host
    roles:
      - role: ironicbadger.ansible_role_proxmox_nag_removal
      - role: proxmox_host
        tags: proxmox
      - role: exterrestris.proxmox_ssl
        tags: ssl

# Main - Common

# Main - Host Specific

# Main - Groups
  - hosts: proxmox_vm
    roles:
      - role: proxmox_vm

  - hosts: nas
    roles:
      - role: mount_disks
      - role: mrlesmithjr.zfs
        tags:
          - disks
          - zfs
      - role: sprat.ansible_role_mergerfs
        tags:
          - disks
          - mergerfs
      - role: bertvv.samba
        tags:
          - samba
      - role: geerlingguy.docker
        tags:
          - docker
      - role: ironicbadger.ansible_role_snapraid
        tags:
          - snapraid
      - role: weareinteractive.ufw
      - role: exterrestris.ansible_role_wsdd

# Final - Common

# Final - Host Specific

# Final - Groups
